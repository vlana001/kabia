<%- include('../includes/head.ejs') %>
<link rel="stylesheet" href="/css/styles.css">
</head>

<body>

    <%- include('../includes/navigation.ejs') %>
    <div class="content">

        <div id="container-page">

            <div id="lateral-menu">
                    <% if (option === "received") { %>
                        <%- include('../includes/lateral-menu-friendship-requests.ejs', {currentLink: 1}) %>
                    <% }%>
                   <% if (option === "send") { %>
                        <%- include('../includes/lateral-menu-friendship-requests.ejs', {currentLink: 2}) %>
                    <% }%>
                   
            </div>

            <div id="page-content">

                <% if (errorMessage) { %>
                <!-- <div class="msg msg-error">
                    <% for (let error of errorMessage) { %>
                    <p class="msg-indiv"><%= error %></p>
                    <% } %>
                </div> -->
                <% } %>

                <% if (option === "send") { %>

                <div id="message-friendship-user"
                    class="msg <%= friendshipRequestsSent.length === 0 ? 'msg-empty' : ''  %>">
                    <% if (friendshipRequestsSent.length!==0) { %>
                    <p id="msg-friendship-user" class="msg-hide msg-indiv"></p>
                    <% } %>
                    <p id="no-msg"
                        class="msg-indiv <%= friendshipRequestsSent.length === 0 ? 'msg-show' : 'msg-hide' %>">
                        No tienes solicitudes de amistad pendientes de aceptacion
                    </p>
                </div>

                <% if (friendshipRequestsSent.length !== 0) { %>

                <div id="fr-sent-cards-list">
                    <% let i = 1 %>
                    <% for (let r of friendshipRequestsSent) { %>
                    <div id="user-<%= i %>" class="friendship-sent-card">
                        <% i++ %>
                        <div>
                            <img class="img-cards-friendship-requests" src="/uploads/<%= r.imageURL %>" alt="">                       
                        </div>
                        <div class="div-cards-actions">
                            <p id="<%= r.usernameNormalized %>" class="username-card">
                                <a href="/users/u/<%= r.usernameNormalized %>">
                                    <%= r.username %>
                                </a>
                            </p>
                            
                            <button class="friendship-actions-btn csfr-btn" id="csfr-btn">
                                <span class="btn-text">Cancelar</span>
                                <span id="btn-cfr-spinner" class=""></span>
                            </button>
                        </div>
                    </div>
                    <% } %>

                </div>
                <% } %>

                <%} %>

                <% if (option === "received") { %>

                <div id="message-friendship-user"
                    class="msg <%= friendshipRequestsReceived.length === 0 ? 'msg-empty' : ''  %>">
                    <% if (friendshipRequestsReceived.length!==0) { %>
                    <p id="msg-friendship-user" class="msg-hide msg-indiv"></p>
                    <% } %>
                    <p id="no-msg"
                        class="msg-indiv <%= friendshipRequestsReceived.length === 0 ? 'msg-show' : 'msg-hide' %>">
                        No tienes nuevas solicitudes de amistad
                    </p>
                </div>


                <% if (friendshipRequestsReceived.length !== 0) { %>

                <div id="fr-received-cards-list">
                    <% let i = 1 %>
                    <% for (let r of friendshipRequestsReceived) { %>
                    <div id="user-<%= i %>" class="friendship-received-card">
                        <% i++ %>
                        <div>
                            <img class="img-cards-friendship-requests" src="/uploads/<%= r.imageURL %>" alt="">                       
                        </div>
                        <div class="div-cards-actions">
                            <p id="<%= r.usernameNormalized %>" class="username-card">
                                <a href="/users/u/<%= r.usernameNormalized %>">
                                    <%= r.username %>
                                </a>
                            </p>
                    
                            <div id="btns-fr-received">
                                <button title="aceptar" class="friendship-actions-btn afr-btn" id="afr-btn">
                                    <span class="btn-text">Aceptar</span>
                                    <span id="btn-afr-spinner" class=""></span>
                                </button>
                                <button title="rechazar" class="friendship-actions-btn rfr-btn" id="rfr-btn">
                                    <span class="btn-text">Rechazar</span>
                                    <span id="btn-rfr-spinner" class=""></span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <% } %>
                </div>
                <% } %>

            </div>

            <%} %>

        </div>
    </div>

    </div>
    <%- include('../includes/end.ejs') %>